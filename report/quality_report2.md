# «Первичное исследование и оценка качества данных» (продолжение) 

## 1. Типы признаков и шкалы измерения

### Задание 1.

### 1. Классификация признаков

| Признак | Тип шкалы | Обоснование |
|---|---|---|
| `season` | **Порядковая** | Есть логический порядок (Весна, Лето...), но интервалы между сезонами условны. |
| `holiday` | **Номинальная** | Бинарный признак. Значения 0 и 1 - метки категорий. |
| `weather` | **Порядковая** | Состояния погоды от "Ясно" (1) до "Ливень/Снег" (4). Порядок важен, но разница между может быть разной. |
| `temp` | **Интервальная** | Измерение в градусах Цельсия. Можно вычислять разность, но не отношения. |
| `humidity` | **Абсолютная** | Есть ноль (0% влажности). Корректно утверждение "влажность выросла в 2 раза". |
| `count` | **Абсолютная** | Дискретная абсолютная шкала. Есть ноль (отсутствие аренд). |

### 2. Смысл агрегатов
Сравним признаки: `season` (Порядковая) и `count` (Абсолютная).

1.  **Среднее арифметическое:**
    *   `count`: **Имеет смысл.** Показывает среднюю нагрузку на сервис.
    *   `season`: **Не имеет смысла.** "Средний сезон 2.5" не интерпретируем, хотя Pandas вычислит это число. Это методологическая ошибка.
2.  **Медиана:**
    *   `count`: **Имеет смысл.** Делит выборку пополам, показывает типичную нагрузку, устойчива к выбросам.
    *   `season`: **Ограниченный смысл.** Можно сказать "половина наблюдений относится к сезонам 1 и 2".
3.  **Мода:**
    *   **Имеет смысл для обоих признаков.** Показывает самое частое значение (самый популярный сезон или самую частую величину спроса).

---

## 2. Пропуски и их природа (MCAR / MAR / MNAR)

### Задание 2. Диагностика (на примере `humidity` ~10% пропусков)

1.  **Гипотезы:**
    *   **MCAR (Совершенно случайно):** Сбой датчика происходит хаотично (например, плохой контакт), не зависит ни от погоды, ни от времени.
    *   **MAR (Случайно, но зависимо):** Вероятность пропуска зависит от другого признака. *Пример:* Датчик чаще отказывает при низкой температуре (`temp` < 0).
    *   **MNAR (Не случайно):** Пропуск зависит от значения самой влажности. *Пример:* Датчик не может зафиксировать влажность > 90% и просто не пишет значение.
2.  **Проверки:**
    *   *Для MAR:* Сравнить распределение температуры (`temp`) для строк, где `humidity` есть, и где `humidity` пропущен. Если средние температуры различаются значимо (t-test) — это MAR.
    *   *Для MCAR:* Проверить корреляцию факта пропуска (бинарный флаг) со всеми остальными признаками. Отсутствие корреляций говорит в пользу MCAR.

### Задание 3. Индикатор пропуска
1.  **Когда факт пропуска несет информацию?** Когда пропуск не случаен (MNAR). Например, в анкете пропуск графы "Наличие автомобиля" часто означает "Нет автомобиля".
2.  **Сигнал о неправильной импутации:** Если модель присваивает высокий вес (feature importance) индикатору пропуска, значит, заполненные нами значения (например, средним) сильно искажают реальность, и модель вынуждена использовать "костыль" в виде индикатора, чтобы отличить реальные данные от выдуманных.
3.  **Примеры:**
    *   *Полезен:* Медицина. Пропуск анализа может означать, что врач не увидел симптомов.
    *   *Бесполезен:* Случайный сбой записи логов на сервере (MCAR).
    *   *Опасен:* Если мы заполнили пропуски в поле "Судимость" значением "Нет", а индикатор удалили. Мы потеряли критическую информацию о неопределенности.

---

## 3. Выбросы

### Задание 4. Выброс — ошибка или сигнал?
Признак: **`count`**. Значение выброса: **977** (при среднем 191).

1.  **Причины:** Это **сигнал**. Вероятная причина — час пик в хорошую погоду или массовое мероприятие в городе. Это объективная природа данных (распределение Пуассона с тяжелым хвостом).
2.  **Что делать (анализ):**
    *   *Удалить:* **Хуже всего.** Мы потеряем информацию о максимальной нагрузке, бизнес не сможет планировать ресурсы для праздников.
    *   *Оставить без изменений:* Приемлемо для моделей на основе деревьев решений (Random Forest, Gradient Boosting).
    *   *Преобразовать:* **Лучший вариант** для линейных моделей. Использовать логарифмирование (`log1p`), чтобы сгладить влияние экстремальных значений, не удаляя их.

---

## 4. Статистики

### Задание 5. Преобразование или винзоризация?
Для признака `count` (сильная правосторонняя асимметрия):

1.  **Предпочтительнее:** **Логарифмирование**. Спрос — это величина, которая может расти экспоненциально. Винзоризация (обрезка хвостов) искусственно занизит реальный спрос в часы пик.
2.  **Влияние:**
    *   *Линейные модели:* Логарифм делает связь с признаками более линейной и улучшает метрики качества.
    *   *Визуализация:* Гистограмма после логарифма становится похожей на "колокол" (нормальное распределение), что облегчает анализ.

### Задание 6. Средние, которые вводят в заблуждение
Для `count`: Mean = 191, Median = 145.

1.  **Почему различаются:** Из-за выбросов (длинного правого хвоста). Несколько часов с очень высокой арендой "тянут" среднее арифметическое вверх.
2.  **Что лучше:** **Медиана (145)** лучше отражает "типичное" значение. Если сказать бизнесу "обычно берут 191 велосипед", то в 60-70% случаев реальный спрос будет ниже этого числа, что приведет к простою техники.

---

## 5. Визуализация

### Задание 7. Неправильная диаграмма
Для отображения зависимости `count` (число) от `temp` (число).

1.  **Худший выбор:** **Круговая диаграмма (Pie Chart)**.
2.  **Ошибки:**
    *   Круговая диаграмма показывает структуру целого, а не корреляцию двух величин.
    *   Визуально невозможно оценить тренд (растет ли спрос с температурой).
    *   Зритель может сделать ложный вывод, что мы сравниваем *доли* температур, а не ищем взаимосвязь.

### Задание 8. Разные графики — одни данные
Пара: `season` (категория) и `count` (число).

1.  **Вариант 1: Bar Chart (Столбчатая диаграмма среднего).**
    *   *Подчёркивает:* Разницу в **среднем** объеме аренды между сезонами. Легко увидеть, где больше.
    *   *Скрывает:* Разброс значений и выбросы.
2.  **Вариант 2: Box Plot (Ящик с усами).**
    *   *Подчёркивает:* **Распределение**, медиану и наличие аномально высоких дней (выбросов) в каждом сезоне.
    *   *Легче заметить:* Что зимой (сезон 4) среднее низкое, но разброс огромный (есть и очень успешные дни, и провальные), чего не видно на Bar Chart.
